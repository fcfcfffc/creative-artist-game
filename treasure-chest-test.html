<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®ç®±ç‚¹å‡»åŠŸèƒ½æµ‹è¯•</title>
    <link rel="stylesheet" href="style.css">
    <style>
        body {
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .test-header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }
        .test-instructions {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            color: white;
        }
        .test-chest-area {
            background: rgba(255, 255, 255, 0.95);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            margin-bottom: 20px;
        }
        .test-status {
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
        }
        .status-item {
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="test-header">
            <h1>ğŸ§ª å®ç®±ç‚¹å‡»åŠŸèƒ½æµ‹è¯•</h1>
            <p>æµ‹è¯•å®ç®±æ˜¯å¦èƒ½æ­£ç¡®å“åº”ç‚¹å‡»å¹¶å¼€å¯</p>
        </div>
        
        <div class="test-instructions">
            <h3>æµ‹è¯•è¯´æ˜ï¼š</h3>
            <ul>
                <li>âœ… ç‚¹å‡»å®ç®±åº”è¯¥æ’­æ”¾åŠ¨ç”»</li>
                <li>âœ… ç‚¹å‡»å®ç®±åº”è¯¥è°ƒç”¨å¼€ç®±å‡½æ•°</li>
                <li>âœ… æœ‰é’¥åŒ™æ—¶åº”è¯¥èƒ½å¼€ç®±</li>
                <li>âœ… æ²¡é’¥åŒ™æ—¶åº”è¯¥æ— æ³•å¼€ç®±</li>
                <li>âœ… å¼€ç®±è¿‡ç¨‹ä¸­åº”è¯¥æ— æ³•é‡å¤å¼€ç®±</li>
            </ul>
        </div>
        
        <div class="test-chest-area">
            <h2>ğŸ—ï¸ å½“å‰é’¥åŒ™æ•°é‡: <span id="test-tickets">3</span></h2>
            
            <!-- æ¨¡æ‹Ÿå®ç®± -->
            <div id="treasure-chest" style="cursor: pointer; font-size: 100px; margin: 20px 0;">
                <div class="crate-icon" id="crate-icon">ğŸ“¦</div>
            </div>
            
            <p>ç‚¹å‡»ä¸Šæ–¹å®ç®±æµ‹è¯•å¼€ç®±åŠŸèƒ½</p>
            
            <div class="test-status">
                <div class="status-item">çŠ¶æ€: <span id="test-status">ç­‰å¾…ç‚¹å‡»</span></div>
                <div class="status-item">æœ€åæ“ä½œ: <span id="last-action">æ— </span></div>
                <div class="status-item">å¼€ç®±æ¬¡æ•°: <span id="open-count">0</span></div>
            </div>
        </div>
        
        <div style="text-align: center;">
            <button onclick="resetTest()" style="padding: 10px 20px; margin: 5px; border: none; border-radius: 5px; background: #3498db; color: white; cursor: pointer;">é‡ç½®æµ‹è¯•</button>
            <button onclick="addTickets()" style="padding: 10px 20px; margin: 5px; border: none; border-radius: 5px; background: #27ae60; color: white; cursor: pointer;">æ·»åŠ é’¥åŒ™</button>
            <button onclick="removeTickets()" style="padding: 10px 20px; margin: 5px; border: none; border-radius: 5px; background: #e74c3c; color: white; cursor: pointer;">ç§»é™¤é’¥åŒ™</button>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        let testOpenCount = 0;
        
        // é‡å†™performGachaå‡½æ•°ç”¨äºæµ‹è¯•
        const originalPerformGacha = window.performGacha || function() {};
        
        window.performGacha = function() {
            testOpenCount++;
            document.getElementById('test-status').textContent = 'å¼€ç®±ä¸­...';
            document.getElementById('last-action').textContent = 'è°ƒç”¨äº†performGacha()';
            document.getElementById('open-count').textContent = testOpenCount;
            
            console.log('æµ‹è¯•: performGachaè¢«è°ƒç”¨ï¼Œå¼€ç®±æ¬¡æ•°:', testOpenCount);
            
            // æ¨¡æ‹Ÿå¼€ç®±è¿‡ç¨‹
            setTimeout(() => {
                document.getElementById('test-status').textContent = 'å¼€ç®±å®Œæˆ';
                gameState.isOpening = false;
            }, 2000);
            
            // è°ƒç”¨åŸå§‹å‡½æ•°ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
            if (originalPerformGacha && typeof originalPerformGacha === 'function') {
                try {
                    originalPerformGacha();
                } catch (error) {
                    console.log('åŸå§‹performGachaå‡½æ•°æ‰§è¡Œå‡ºé”™:', error);
                }
            }
        };
        
        // æµ‹è¯•è¾…åŠ©å‡½æ•°
        function resetTest() {
            testOpenCount = 0;
            gameState.tickets = 3;
            gameState.isOpening = false;
            document.getElementById('test-tickets').textContent = gameState.tickets;
            document.getElementById('test-status').textContent = 'ç­‰å¾…ç‚¹å‡»';
            document.getElementById('last-action').textContent = 'é‡ç½®æµ‹è¯•';
            document.getElementById('open-count').textContent = testOpenCount;
            console.log('æµ‹è¯•å·²é‡ç½®');
        }
        
        function addTickets() {
            gameState.tickets += 1;
            document.getElementById('test-tickets').textContent = gameState.tickets;
            document.getElementById('last-action').textContent = 'æ·»åŠ äº†1æŠŠé’¥åŒ™';
            console.log('æ·»åŠ é’¥åŒ™ï¼Œå½“å‰:', gameState.tickets);
        }
        
        function removeTickets() {
            if (gameState.tickets > 0) {
                gameState.tickets -= 1;
                document.getElementById('test-tickets').textContent = gameState.tickets;
                document.getElementById('last-action').textContent = 'ç§»é™¤äº†1æŠŠé’¥åŒ™';
                console.log('ç§»é™¤é’¥åŒ™ï¼Œå½“å‰:', gameState.tickets);
            }
        }
        
        // ç›‘å¬å®ç®±ç‚¹å‡»
        document.addEventListener('DOMContentLoaded', function() {
            const treasureChest = document.getElementById('treasure-chest');
            if (treasureChest) {
                console.log('å®ç®±å…ƒç´ æ‰¾åˆ°ï¼Œæ·»åŠ æµ‹è¯•ç›‘å¬å™¨');
                
                // æ·»åŠ é¢å¤–çš„æµ‹è¯•ç›‘å¬å™¨
                treasureChest.addEventListener('click', function() {
                    console.log('æµ‹è¯•: å®ç®±è¢«ç‚¹å‡»');
                    document.getElementById('last-action').textContent = 'ç‚¹å‡»äº†å®ç®±';
                    
                    if (gameState.tickets <= 0) {
                        document.getElementById('test-status').textContent = 'æ²¡æœ‰é’¥åŒ™';
                        console.log('æµ‹è¯•: æ²¡æœ‰é’¥åŒ™ï¼Œæ— æ³•å¼€ç®±');
                    } else if (gameState.isOpening) {
                        document.getElementById('test-status').textContent = 'æ­£åœ¨å¼€ç®±ä¸­';
                        console.log('æµ‹è¯•: æ­£åœ¨å¼€ç®±ä¸­ï¼Œæ— æ³•é‡å¤å¼€ç®±');
                    } else {
                        document.getElementById('test-status').textContent = 'ç‚¹å‡»æˆåŠŸ';
                        console.log('æµ‹è¯•: ç‚¹å‡»æ¡ä»¶æ»¡è¶³ï¼Œåº”è¯¥ä¼šå¼€ç®±');
                    }
                });
            } else {
                console.error('æµ‹è¯•: æœªæ‰¾åˆ°å®ç®±å…ƒç´ ');
            }
        });
        
        console.log('å®ç®±ç‚¹å‡»æµ‹è¯•é¡µé¢å·²å‡†å¤‡å°±ç»ª');
    </script>
</body>
</html>